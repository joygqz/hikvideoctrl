# 海康威视视频控制库演示示例

这个示例展示了如何使用 `hikvideoctrl` 库来控制海康威视设备和播放视频。

## 🚀 快速开始

### 1. 准备工作

确保你已经构建了主库：

```bash
cd ..
pnpm build
```

### 2. 启动示例

使用任何静态文件服务器运行示例，比如：

```bash
# 使用 Python
python -m http.server 8080

# 使用 Node.js serve
npx serve .

# 使用 Live Server (VS Code 插件)
# 右键 index.html -> Open with Live Server
```

### 3. 打开浏览器

访问 `http://localhost:8080/index.html`

## 📋 功能展示

### 🔌 设备连接
- **设备登录**: 输入设备IP、端口、用户名、密码进行连接
- **设备登出**: 断开与设备的连接
- **连接状态监控**: 实时显示连接状态

### 📺 视频播放
- **实时预览**: 支持主码流和子码流切换
- **播放控制**: 开始/停止预览
- **窗口管理**: 自适应视频窗口大小

### 🎯 PTZ 控制
- **方向控制**: 上、下、左、右、斜向移动
- **预置位管理**: 设置和调用预置位
- **停止控制**: 停止当前PTZ操作

### 📷 图片和录像
- **实时抓拍**: 抓取当前视频帧并保存
- **本地录像**: 开始/停止本地录像
- **文件管理**: 自动生成唯一文件名

### 📊 状态监控
- **连接状态**: 显示设备连接状态
- **播放状态**: 显示视频播放状态  
- **设备信息**: 显示设备型号、固件版本等
- **操作日志**: 记录所有操作和事件

## 🎨 界面特色

- **现代化设计**: 采用渐变背景和毛玻璃效果
- **响应式布局**: 支持桌面端和移动端
- **实时反馈**: 操作结果即时显示
- **状态指示**: 直观的颜色状态提示
- **操作日志**: 完整的操作记录和错误提示

## 🔧 自定义配置

### 修改默认设备信息

编辑 `index.html` 中的默认值：

```javascript
// 默认设备信息
<input type="text" id="deviceIP" value="192.168.1.100" placeholder="请输入设备IP">
<input type="number" id="devicePort" value="8000" placeholder="设备端口">
<input type="text" id="username" value="admin" placeholder="用户名">
```

### 调整视频窗口大小

修改 CSS 中的 `#videoContainer` 样式：

```css
#videoContainer {
  width: 100%;
  height: 400px; /* 修改这里调整高度 */
  background: #000;
  border-radius: 8px;
  border: 2px solid #ddd;
}
```

### 添加自定义事件处理

在 `initController()` 函数中添加更多事件监听器：

```javascript
controller.on(EVENTS.CUSTOM_EVENT, (data) => {
  log(`自定义事件: ${data}`, 'info');
});
```

## 📱 移动端适配

示例已经针对移动端进行了优化：

- 响应式网格布局
- 触摸友好的按钮大小
- 自适应字体和间距
- 移动端PTZ控制优化

## 🛠️ 故障排除

### 常见问题

1. **无法连接设备**
   - 检查设备IP和端口是否正确
   - 确认设备支持无插件模式
   - 检查网络连接和防火墙设置

2. **视频无法播放**
   - 确认设备已正常连接
   - 检查码流设置是否正确
   - 尝试切换主/子码流

3. **PTZ控制无响应**
   - 确认设备支持PTZ功能
   - 检查用户权限是否足够
   - 确认设备当前不在其他控制中

4. **浏览器兼容性**
   - 建议使用 Chrome 60+ 或 Firefox 55+
   - 确保浏览器支持 ES6 模块
   - 检查是否启用了必要的权限

### 调试技巧

1. **查看控制台**: 打开浏览器开发者工具查看详细错误
2. **检查日志**: 观察页面中的操作日志输出
3. **网络监控**: 使用开发者工具监控网络请求
4. **事件追踪**: 添加更多事件监听器进行调试

## 📚 相关文档

- [主库文档](../README.md)
- [API 参考](../src/lib/HikVideoController.ts)
- [常量定义](../src/utils/constants.ts)
- [海康威视官方文档](https://open.hikvision.com/)

## 🤝 贡献

欢迎提交改进建议和Pull Request！

---

**注意**: 使用本示例需要有可访问的海康威视设备，并确保设备固件支持无插件模式。
